(function(S,x){typeof exports=="object"&&typeof module<"u"?x(exports,require("qrcode-generator")):typeof define=="function"&&define.amd?define(["exports","qrcode-generator"],x):(S=typeof globalThis<"u"?globalThis:S||self,x(S.QrCodeStyling={},S.qrcodeGenerator))})(this,function(S,x){"use strict";const I={numeric:"Numeric",alphanumeric:"Alphanumeric",byte:"Byte",kanji:"Kanji"};function rt(l){switch(!0){case/^[0-9]*$/.test(l):return I.numeric;case/^[0-9A-Z $%*+\-./:]*$/.test(l):return I.alphanumeric;default:return I.byte}}const E=l=>!!l&&typeof l=="object"&&!Array.isArray(l);function k(l,...e){if(!e.length)return l;const t=e.shift();return t===void 0||!E(l)||!E(t)?l:(l={...l},Object.keys(t).forEach(n=>{const i=l[n],r=t[n];Array.isArray(i)&&Array.isArray(r)?l[n]=r:E(i)&&E(r)?l[n]=k(Object.assign({},i),r):l[n]=r}),k(l,...e))}function G(l,e){const t=document.createElement("a");t.download=e,t.href=l,document.body.appendChild(t),t.click(),document.body.removeChild(t)}function st({originalHeight:l,originalWidth:e,maxHiddenDots:t,maxHiddenAxisDots:n,dotSize:i}){const r={x:0,y:0},s={x:0,y:0};if(l<=0||e<=0||t<=0||i<=0)return{height:0,width:0,hideYDots:0,hideXDots:0};const o=l/e;return r.x=Math.floor(Math.sqrt(t/o)),r.x<=0&&(r.x=1),n&&n<r.x&&(r.x=n),r.x%2===0&&r.x--,s.x=r.x*i,r.y=1+2*Math.ceil((r.x*o-1)/2),s.y=Math.round(s.x*o),(r.y*r.x>t||n&&n<r.y)&&(n&&n<r.y?(r.y=n,r.y%2===0&&r.x--):r.y-=2,s.y=r.y*i,r.x=1+2*Math.ceil((r.y/o-1)/2),s.x=Math.round(s.y/o)),{height:s.y,width:s.x,hideYDots:r.y,hideXDots:r.x}}async function ot(l){return new Promise(e=>{const t=new XMLHttpRequest;t.onload=function(){const n=new FileReader;n.onloadend=function(){e(n.result)},n.readAsDataURL(t.response)},t.open("GET",l),t.responseType="blob",t.send()})}const U={L:.07,M:.15,Q:.25,H:.3},A={dots:"dots",randomDots:"random-dots",rounded:"rounded",verticalLines:"vertical-lines",horizontalLines:"horizontal-lines",classy:"classy",classyRounded:"classy-rounded",square:"square",extraRounded:"extra-rounded"};class B{constructor({svg:e,type:t}){this._svg=e,this._type=t}draw(e,t,n,i){const r=this._type;let s;switch(r){case A.dots:s=this._drawDot;break;case A.randomDots:s=this._drawRandomDot;break;case A.classy:s=this._drawClassy;break;case A.classyRounded:s=this._drawClassyRounded;break;case A.rounded:s=this._drawRounded;break;case A.verticalLines:s=this._drawVerticalLines;break;case A.horizontalLines:s=this._drawHorizontalLines;break;case A.extraRounded:s=this._drawExtraRounded;break;case A.square:default:s=this._drawSquare}s.call(this,{x:e,y:t,size:n,getNeighbor:i})}_rotateFigure({x:e,y:t,size:n,rotation:i=0,draw:r}){var a;const s=e+n/2,o=t+n/2;r(),(a=this._element)==null||a.setAttribute("transform",`rotate(${180*i/Math.PI},${s},${o})`)}_basicDot(e){const{size:t,x:n,y:i}=e;this._rotateFigure({...e,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(n+t/2)),this._element.setAttribute("cy",String(i+t/2)),this._element.setAttribute("r",String(t/2))}})}_basicSquare(e){const{size:t,x:n,y:i}=e;this._rotateFigure({...e,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(n)),this._element.setAttribute("y",String(i)),this._element.setAttribute("width",String(t)),this._element.setAttribute("height",String(t))}})}_basicSideRounded(e){const{size:t,x:n,y:i}=e;this._rotateFigure({...e,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${n} ${i}v ${t}h ${t/2}a ${t/2} ${t/2}, 0, 0, 0, 0 ${-t}`)}})}_basicCornerRounded(e){const{size:t,x:n,y:i}=e;this._rotateFigure({...e,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${n} ${i}v ${t}h ${t}v ${-t/2}a ${t/2} ${t/2}, 0, 0, 0, ${-t/2} ${-t/2}`)}})}_basicCornerExtraRounded(e){const{size:t,x:n,y:i}=e;this._rotateFigure({...e,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${n} ${i}v ${t}h ${t}a ${t} ${t}, 0, 0, 0, ${-t} ${-t}`)}})}_basicCornersRounded(e){const{size:t,x:n,y:i}=e;this._rotateFigure({...e,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${n} ${i}v ${t/2}a ${t/2} ${t/2}, 0, 0, 0, ${t/2} ${t/2}h ${t/2}v ${-t/2}a ${t/2} ${t/2}, 0, 0, 0, ${-t/2} ${-t/2}`)}})}_drawDot({x:e,y:t,size:n}){this._basicDot({x:e,y:t,size:n,rotation:0})}_drawRandomDot({x:e,y:t,size:n}){const i=Math.random()*.4+.6;this._basicDot({x:e,y:t,size:n*i,rotation:0})}_drawSquare({x:e,y:t,size:n}){this._basicSquare({x:e,y:t,size:n,rotation:0})}_drawRounded({x:e,y:t,size:n,getNeighbor:i}){const r=i?+i(-1,0):0,s=i?+i(1,0):0,o=i?+i(0,-1):0,a=i?+i(0,1):0,d=r+s+o+a;if(d===0){this._basicDot({x:e,y:t,size:n,rotation:0});return}if(d>2||r&&s||o&&a){this._basicSquare({x:e,y:t,size:n,rotation:0});return}if(d===2){let h=0;r&&o?h=Math.PI/2:o&&s?h=Math.PI:s&&a&&(h=-Math.PI/2),this._basicCornerRounded({x:e,y:t,size:n,rotation:h});return}if(d===1){let h=0;o?h=Math.PI/2:s?h=Math.PI:a&&(h=-Math.PI/2),this._basicSideRounded({x:e,y:t,size:n,rotation:h});return}}_drawVerticalLines({x:e,y:t,size:n,getNeighbor:i}){const r=i?+i(-1,0):0,s=i?+i(1,0):0,o=i?+i(0,-1):0,a=i?+i(0,1):0;if(r+s+o+a===0||r&&!(o||a)||s&&!(o||a)){this._basicDot({x:e,y:t,size:n,rotation:0});return}if(o&&a){this._basicSquare({x:e,y:t,size:n,rotation:0});return}if(o&&!a){const h=Math.PI/2;this._basicSideRounded({x:e,y:t,size:n,rotation:h});return}if(a&&!o){const h=-Math.PI/2;this._basicSideRounded({x:e,y:t,size:n,rotation:h});return}}_drawHorizontalLines({x:e,y:t,size:n,getNeighbor:i}){const r=i?+i(-1,0):0,s=i?+i(1,0):0,o=i?+i(0,-1):0,a=i?+i(0,1):0;if(r+s+o+a===0||o&&!(r||s)||a&&!(r||s)){this._basicDot({x:e,y:t,size:n,rotation:0});return}if(r&&s){this._basicSquare({x:e,y:t,size:n,rotation:0});return}if(r&&!s){this._basicSideRounded({x:e,y:t,size:n,rotation:0});return}if(s&&!r){const h=Math.PI;this._basicSideRounded({x:e,y:t,size:n,rotation:h});return}}_drawExtraRounded({x:e,y:t,size:n,getNeighbor:i}){const r=i?+i(-1,0):0,s=i?+i(1,0):0,o=i?+i(0,-1):0,a=i?+i(0,1):0,d=r+s+o+a;if(d===0){this._basicDot({x:e,y:t,size:n,rotation:0});return}if(d>2||r&&s||o&&a){this._basicSquare({x:e,y:t,size:n,rotation:0});return}if(d===2){let h=0;r&&o?h=Math.PI/2:o&&s?h=Math.PI:s&&a&&(h=-Math.PI/2),this._basicCornerExtraRounded({x:e,y:t,size:n,rotation:h});return}if(d===1){let h=0;o?h=Math.PI/2:s?h=Math.PI:a&&(h=-Math.PI/2),this._basicSideRounded({x:e,y:t,size:n,rotation:h});return}}_drawClassy({x:e,y:t,size:n,getNeighbor:i}){const r=i?+i(-1,0):0,s=i?+i(1,0):0,o=i?+i(0,-1):0,a=i?+i(0,1):0;if(r+s+o+a===0){this._basicCornersRounded({x:e,y:t,size:n,rotation:Math.PI/2});return}if(!r&&!o){this._basicCornerRounded({x:e,y:t,size:n,rotation:-Math.PI/2});return}if(!s&&!a){this._basicCornerRounded({x:e,y:t,size:n,rotation:Math.PI/2});return}this._basicSquare({x:e,y:t,size:n,rotation:0})}_drawClassyRounded({x:e,y:t,size:n,getNeighbor:i}){const r=i?+i(-1,0):0,s=i?+i(1,0):0,o=i?+i(0,-1):0,a=i?+i(0,1):0;if(r+s+o+a===0){this._basicCornersRounded({x:e,y:t,size:n,rotation:Math.PI/2});return}if(!r&&!o){this._basicCornerExtraRounded({x:e,y:t,size:n,rotation:-Math.PI/2});return}if(!s&&!a){this._basicCornerExtraRounded({x:e,y:t,size:n,rotation:Math.PI/2});return}this._basicSquare({x:e,y:t,size:n,rotation:0})}}const C={dot:"dot",square:"square",extraRounded:"extra-rounded",flowerIn:"flowerIn",flowerOut:"flowerOut",marker:"marker",oneRounded:"oneRounded"};function at(l,e){const t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"svg");n.setAttribute("width",l.toString()),n.setAttribute("height",l.toString()),n.setAttribute("viewBox","0 0 200 200"),n.setAttribute("fill",e);const i=document.createElementNS(t,"path");return i.setAttribute("d","M 0 0 L 0 137.146 C 0 171.432 28.572 200.004 62.859 200.004 L 135.717 200.004 C 171.432 200.004 200.004 171.432 200.004 137.146 L 200.004 62.859 C 200.004 28.572 171.432 0 137.146 0 L 0 0 Z M 131.432 171.432 L 68.573 171.432 C 47.144 171.432 28.572 152.861 28.572 131.432 L 28.572 28.572 L 131.432 28.572 C 152.861 28.572 171.432 47.144 171.432 68.573 L 171.432 131.432 C 171.432 152.861 152.861 171.432 131.432 171.432 Z"),n.appendChild(i),n}function ct(l,e){const t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"svg");n.setAttribute("width",l.toString()),n.setAttribute("height",l.toString()),n.setAttribute("viewBox","0 0 200 200"),n.setAttribute("fill",e);const i=document.createElementNS(t,"path");return i.setAttribute("d","M0 0v200.004h200.004V0H0zm100.002 171.432c-40.0008 0-71.43-31.4292-71.43-71.43s31.4292-71.43 71.43-71.43 71.43 31.4292 71.43 71.43-31.4292 71.43-71.43 71.43z"),n.appendChild(i),n}function ht(l,e){const t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"svg");n.setAttribute("width",l.toString()),n.setAttribute("height",l.toString()),n.setAttribute("viewBox","0 0 200 200"),n.setAttribute("fill",e);const i=document.createElementNS(t,"path");return i.setAttribute("d","M200.06 0H62.88C28.58 0 0 28.58 0 62.88v137.18h200.06V0zM28.58 171.48V68.59c0-21.43 18.58-40.01 40.01-40.01h102.89v142.9H28.58z"),n.appendChild(i),n}class dt{constructor({svg:e,type:t,color:n}){this._svg=e,this._type=t,this._color=n}draw(e,t,n,i){const r=this._type;let s;switch(r){case C.square:s=this._drawSquare;break;case C.extraRounded:s=this._drawExtraRounded;break;case C.flowerIn:s=this._drawFlowerIn;break;case C.flowerOut:s=this._drawFlowerOut;break;case C.marker:s=this._drawMarker;break;case C.oneRounded:s=this._drawOneRounded;break;case C.dot:default:s=this._drawDot}s.call(this,{x:e,y:t,size:n,rotation:i})}_rotateFigure({x:e,y:t,size:n,rotation:i=0,draw:r}){var a;const s=e+n/2,o=t+n/2;r(),(a=this._element)==null||a.setAttribute("transform",`rotate(${180*i/Math.PI},${s},${o})`)}_basicDot(e){const{size:t,x:n,y:i}=e,r=t/7;this._rotateFigure({...e,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${n+t/2} ${i}a ${t/2} ${t/2} 0 1 0 0.1 0zm 0 ${r}a ${t/2-r} ${t/2-r} 0 1 1 -0.1 0Z`)}})}_basicSquare(e){const{size:t,x:n,y:i}=e,r=t/7;this._rotateFigure({...e,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${n} ${i}v ${t}h ${t}v ${-t}zM ${n+r} ${i+r}h ${t-2*r}v ${t-2*r}h ${-t+2*r}z`)}})}_basicExtraRounded(e){const{size:t,x:n,y:i}=e,r=t/7;this._rotateFigure({...e,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${n} ${i+2.5*r}v ${2*r}a ${2.5*r} ${2.5*r}, 0, 0, 0, ${r*2.5} ${r*2.5}h ${2*r}a ${2.5*r} ${2.5*r}, 0, 0, 0, ${r*2.5} ${-r*2.5}v ${-2*r}a ${2.5*r} ${2.5*r}, 0, 0, 0, ${-r*2.5} ${-r*2.5}h ${-2*r}a ${2.5*r} ${2.5*r}, 0, 0, 0, ${-r*2.5} ${r*2.5}M ${n+2.5*r} ${i+r}h ${2*r}a ${1.5*r} ${1.5*r}, 0, 0, 1, ${r*1.5} ${r*1.5}v ${2*r}a ${1.5*r} ${1.5*r}, 0, 0, 1, ${-r*1.5} ${r*1.5}h ${-2*r}a ${1.5*r} ${1.5*r}, 0, 0, 1, ${-r*1.5} ${-r*1.5}v ${-2*r}a ${1.5*r} ${1.5*r}, 0, 0, 1, ${r*1.5} ${-r*1.5}`)}})}_drawDot({x:e,y:t,size:n,rotation:i}){this._basicDot({x:e,y:t,size:n,rotation:i})}_drawSquare({x:e,y:t,size:n,rotation:i}){this._basicSquare({x:e,y:t,size:n,rotation:i})}_drawExtraRounded({x:e,y:t,size:n,rotation:i}){this._basicExtraRounded({x:e,y:t,size:n,rotation:i})}_basicFlower(e){const{x:t,y:n,size:i,rotation:r}=e;this._rotateFigure({...e,draw:()=>{const o=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");o.setAttribute("x",String(t)),o.setAttribute("y",String(n)),o.setAttribute("width",String(i)),o.setAttribute("height",String(i));const a=r*180/Math.PI,d=t+i/2,h=n+i/2,u=o.getAttribute("transform")||"";o.setAttribute("transform",`${u} rotate(${a},${d},${h})`);const c=at(i,this._color??"black");o.append(c),this._svg.appendChild(o)}})}_drawFlowerIn({x:e,y:t,size:n,rotation:i}){this._basicFlower({x:e,y:t,size:n,rotation:i})}_drawFlowerOut({x:e,y:t,size:n,rotation:i}){this._basicFlower({x:e,y:t,size:n,rotation:i+Math.PI})}_basicMarker(e){const{x:t,y:n,size:i,rotation:r}=e;this._rotateFigure({...e,draw:()=>{const o=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");o.setAttribute("x",String(t)),o.setAttribute("y",String(n)),o.setAttribute("width",String(i)),o.setAttribute("height",String(i));const a=ct(i,this._color??"black");o.append(a),this._svg.appendChild(o)}})}_drawMarker({x:e,y:t,size:n,rotation:i}){this._basicMarker({x:e,y:t,size:n,rotation:i})}_basicOneRounded(e){const{x:t,y:n,size:i,rotation:r}=e;this._rotateFigure({...e,draw:()=>{const o=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");o.setAttribute("x",String(t)),o.setAttribute("y",String(n)),o.setAttribute("width",String(i)),o.setAttribute("height",String(i));const a=r*180/Math.PI,d=t+i/2,h=n+i/2,u=o.getAttribute("transform")||"";o.setAttribute("transform",`${u} rotate(${a},${d},${h})`);const c=ht(i,this._color??"black");o.append(c),this._svg.appendChild(o)}})}_drawOneRounded({x:e,y:t,size:n,rotation:i}){this._basicOneRounded({x:e,y:t,size:n,rotation:i})}}const M={dot:"dot",square:"square",heart:"heart",star:"star",polygon5:"polygon5",polygon7:"polygon7",bezier:"bezier",dropIn:"dropIn",dropOut:"dropOut",oneRounded:"oneRounded"};function lt(l,e){const t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"svg");n.setAttribute("width",l.toString()),n.setAttribute("height",l.toString()),n.setAttribute("viewBox","0 -960 960 960"),n.setAttribute("fill",e);const i=document.createElementNS(t,"path");return i.setAttribute("d","m480-120-58-52q-101-91-167-157T150-447.5Q111-500 95.5-544T80-634q0-94 63-157t157-63q52 0 99 22t81 62q34-40 81-62t99-22q94 0 157 63t63 157q0 46-15.5 90T810-447.5Q771-395 705-329T538-172l-58 52Z"),n.appendChild(i),n}function ut(l,e){const t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"svg");n.setAttribute("width",l.toString()),n.setAttribute("height",l.toString()),n.setAttribute("viewBox","0 0 500 500"),n.setAttribute("fill",e);const i=document.createElementNS(t,"path");return i.setAttribute("d","M249.999 499.998C108.3329 499.998 0 391.6651 0 249.999V0h249.999c141.6661 0 249.999 108.3329 249.999 249.999S391.6651 499.998 249.999 499.998z"),n.appendChild(i),n}function pt(l,e){const t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"svg");n.setAttribute("width",l.toString()),n.setAttribute("height",l.toString()),n.setAttribute("viewBox","0 0 100 100"),n.setAttribute("fill",e);const i=document.createElementNS(t,"path");return i.setAttribute("d","M71.68 100.02H28.34C13.34 100.02 0 86.68 0 71.68V0h71.68c15 0 28.34 13.34 28.34 28.34v43.34c0 15-13.34 28.34-28.34 28.34z"),n.appendChild(i),n}class gt{constructor({svg:e,type:t,color:n}){this._svg=e,this._type=t,this._color=n}draw(e,t,n,i){const r=this._type;let s;switch(r){case M.square:s=this._drawSquare;break;case M.heart:s=this._drawHeart;break;case M.star:s=this._drawStar;break;case M.polygon5:s=this._drawPolygon5;break;case M.polygon7:s=this._drawPolygon7;break;case M.bezier:s=this._draeBezier;break;case M.dropIn:s=this._drawDropIn;break;case M.dropOut:s=this._drawDropOut;break;case M.oneRounded:s=this._drawOneRounded;break;case M.dot:default:s=this._drawDot}s.call(this,{x:e,y:t,size:n,rotation:i})}_rotateFigure({x:e,y:t,size:n,rotation:i=0,draw:r}){if(r(),this._element){const s=e+n/2,o=t+n/2,a=i*180/Math.PI,d=this._element.getAttribute("transform")||"";this._element.setAttribute("transform",`${d} rotate(${a},${s},${o})`)}}_basicDot(e){const{size:t,x:n,y:i}=e;this._rotateFigure({...e,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(n+t/2)),this._element.setAttribute("cy",String(i+t/2)),this._element.setAttribute("r",String(t/2))}})}_basicSquare(e){const{size:t,x:n,y:i}=e;this._rotateFigure({...e,draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(n)),this._element.setAttribute("y",String(i)),this._element.setAttribute("width",String(t)),this._element.setAttribute("height",String(t))}})}_basicHeart(e){const{x:t,y:n,size:i,rotation:r}=e;this._rotateFigure({...e,draw:()=>{const o=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");o.setAttribute("x",String(t)),o.setAttribute("y",String(n)),o.setAttribute("width",String(i)),o.setAttribute("height",String(i));const a=lt(i,this._color??"black");o.append(a),this._svg.appendChild(o)}})}_drawDot({x:e,y:t,size:n,rotation:i}){this._basicDot({x:e,y:t,size:n,rotation:i})}_drawSquare({x:e,y:t,size:n,rotation:i}){this._basicSquare({x:e,y:t,size:n,rotation:i})}_drawHeart({x:e,y:t,size:n,rotation:i}){this._basicHeart({x:e-.2*n/2,y:t-.2*n/2,size:n*(1+.2),rotation:i})}_drawStar({x:e,y:t,size:n,rotation:i}){const s=document.createElementNS("http://www.w3.org/2000/svg","polygon"),o=1.2;n*=o,e-=(n*o-n)/2,t-=(n*o-n)/2;const a=e+n/2,d=t+n/2,h=n/2,u=h/2,c=[];for(let p=0;p<10;p++){const g=p%2===0?h:u,b=p*36-90,m=Math.PI/180*b,w=a+g*Math.cos(m),_=d+g*Math.sin(m);c.push(`${w},${_}`)}s.setAttribute("points",c.join(" ")),this._rotateFigure({x:e,y:t,size:n,draw:()=>{this._element=s}})}_drawPolygon7({x:e,y:t,size:n,rotation:i}){const s=document.createElementNS("http://www.w3.org/2000/svg","polygon"),o=e+n/2,a=t+n/2,d=n/2,h=[];for(let u=0;u<7;u++){const c=o+d*Math.cos(u*2*Math.PI/7-Math.PI/2),p=a+d*Math.sin(u*2*Math.PI/7-Math.PI/2);h.push(`${c},${p}`)}s.setAttribute("points",h.join(" ")),this._rotateFigure({x:e,y:t,size:n,draw:()=>{this._element=s}})}_drawPolygon5({x:e,y:t,size:n,rotation:i}){const s=document.createElementNS("http://www.w3.org/2000/svg","polygon"),o=e+n/2,a=t+n/2,d=n/2,h=[];for(let u=0;u<5;u++){const c=o+d*Math.cos(u*2*Math.PI/5-Math.PI/2),p=a+d*Math.sin(u*2*Math.PI/5-Math.PI/2);h.push(`${c},${p}`)}s.setAttribute("points",h.join(" ")),this._rotateFigure({x:e,y:t,size:n,draw:()=>{this._element=s}})}_draeBezier({x:e,y:t,size:n,rotation:i}){const s=document.createElementNS("http://www.w3.org/2000/svg","path"),o=n/6,a=`M${e+6*o},${t+6*o} C${e+4.1*o},${t+5.4*o} ${e+1.9*o},${t+5.4*o} ${e},${t+6*o} L${e},${t} C${e+1.9*o},${t+.6*o} ${e+4.1*o},${t+.6*o} ${e+6*o},${t} Z`;s.setAttribute("d",a),this._rotateFigure({x:e,y:t,size:n,draw:()=>{this._element=s}})}_basicDrop(e){const{x:t,y:n,size:i,rotation:r}=e;this._rotateFigure({x:t,y:n,size:i,rotation:r,draw:()=>{const o=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");o.setAttribute("x",String(t)),o.setAttribute("y",String(n)),o.setAttribute("width",String(i)),o.setAttribute("height",String(i));const a=r*180/Math.PI,d=t+i/2,h=n+i/2,u=o.getAttribute("transform")||"";o.setAttribute("transform",`${u} rotate(${a},${d},${h})`);const c=ut(i,this._color??"black");o.append(c),this._svg.appendChild(o)}})}_drawDropIn({x:e,y:t,size:n,rotation:i}){this._basicDrop({x:e-5e-4*n/2,y:t-5e-4*n/2,size:n*(1+5e-4),rotation:i})}_drawDropOut({x:e,y:t,size:n,rotation:i}){this._basicDrop({x:e-5e-4*n/2,y:t-5e-4*n/2,size:n*(1+5e-4),rotation:i+Math.PI})}_basicOneRounded(e){const{x:t,y:n,size:i,rotation:r}=e;this._rotateFigure({x:t,y:n,size:i,rotation:r,draw:()=>{const o=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");o.setAttribute("x",String(t)),o.setAttribute("y",String(n)),o.setAttribute("width",String(i)),o.setAttribute("height",String(i));const a=r*180/Math.PI,d=t+i/2,h=n+i/2,u=o.getAttribute("transform")||"";o.setAttribute("transform",`${u} rotate(${a},${d},${h})`);const c=pt(i,this._color??"black");o.append(c),this._svg.appendChild(o)}})}_drawOneRounded({x:e,y:t,size:n,rotation:i}){this._basicOneRounded({x:e,y:t,size:n,rotation:i+Math.PI})}}const X={radial:"radial",linear:"linear"},P={square:"square",circle:"circle"},O=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],q=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]];class mt{constructor(e){this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("width",String(e.width)),this._element.setAttribute("height",String(e.height)),this._defs=document.createElementNS("http://www.w3.org/2000/svg","defs"),this._element.appendChild(this._defs),this._options=e}get width(){return this._options.width}get height(){return this._options.height}getElement(){return this._element}async drawQR(e){const t=e.getModuleCount(),n=Math.min(this._options.width,this._options.height)-this._options.margin*2,i=this._options.shape===P.circle?n/Math.sqrt(2):n,r=Math.floor(i/t);let s={hideXDots:0,hideYDots:0,width:0,height:0};if(this._qr=e,this._options.image){if(await this.loadImage(),!this._image)return;const{imageOptions:o,qrOptions:a}=this._options,d=o.imageSize*U[a.errorCorrectionLevel],h=Math.floor(d*t*t);s=st({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:h,maxHiddenAxisDots:t-14,dotSize:r})}this.drawBackground(),this.drawDots((o,a)=>{var d,h,u,c,p,g;return!(this._options.imageOptions.hideBackgroundDots&&o>=(t-s.hideXDots)/2&&o<(t+s.hideXDots)/2&&a>=(t-s.hideYDots)/2&&a<(t+s.hideYDots)/2||(d=O[o])!=null&&d[a]||(h=O[o-t+7])!=null&&h[a]||(u=O[o])!=null&&u[a-t+7]||(c=q[o])!=null&&c[a]||(p=q[o-t+7])!=null&&p[a]||(g=q[o])!=null&&g[a-t+7])}),this.drawCorners(),this._options.image&&await this.drawImage({width:s.width,height:s.height,count:t,dotSize:r})}drawBackground(){var n,i,r;const e=this._element,t=this._options;if(e){const s=(n=t.backgroundOptions)==null?void 0:n.gradient,o=(i=t.backgroundOptions)==null?void 0:i.color;if((s||o)&&this._createColor({options:s,color:o,additionalRotation:0,x:0,y:0,height:t.height,width:t.width,name:"background-color"}),(r=t.backgroundOptions)!=null&&r.round){const a=Math.min(t.width,t.height),d=document.createElementNS("http://www.w3.org/2000/svg","rect");this._backgroundClipPath=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._backgroundClipPath.setAttribute("id","clip-path-background-color"),this._defs.appendChild(this._backgroundClipPath),d.setAttribute("x",String((t.width-a)/2)),d.setAttribute("y",String((t.height-a)/2)),d.setAttribute("width",String(a)),d.setAttribute("height",String(a)),d.setAttribute("rx",String(a/2*t.backgroundOptions.round)),this._backgroundClipPath.appendChild(d)}}}drawDots(e){var h,u;if(!this._qr)throw"QR code is not defined";const t=this._options,n=this._qr.getModuleCount();if(n>t.width||n>t.height)throw"The canvas is too small.";const i=Math.min(t.width,t.height)-t.margin*2,r=t.shape===P.circle?i/Math.sqrt(2):i,s=Math.floor(r/n),o=Math.floor((t.width-n*s)/2),a=Math.floor((t.height-n*s)/2),d=new B({svg:this._element,type:t.dotsOptions.type});this._dotsClipPath=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._dotsClipPath.setAttribute("id","clip-path-dot-color"),this._defs.appendChild(this._dotsClipPath),this._createColor({options:(h=t.dotsOptions)==null?void 0:h.gradient,color:t.dotsOptions.color,additionalRotation:0,x:0,y:0,height:t.height,width:t.width,name:"dot-color"});for(let c=0;c<n;c++)for(let p=0;p<n;p++)e&&!e(c,p)||(u=this._qr)!=null&&u.isDark(c,p)&&(d.draw(o+c*s,a+p*s,s,(g,b)=>c+g<0||p+b<0||c+g>=n||p+b>=n||e&&!e(c+g,p+b)?!1:!!this._qr&&this._qr.isDark(c+g,p+b)),d._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(d._element));if(t.shape===P.circle){const c=Math.floor((i/s-n)/2),p=n+c*2,g=o-c*s,b=a-c*s,m=[],w=Math.floor(p/2);for(let _=0;_<p;_++){m[_]=[];for(let f=0;f<p;f++){if(_>=c-1&&_<=p-c&&f>=c-1&&f<=p-c){m[_][f]=0;continue}if(Math.sqrt((_-w)*(_-w)+(f-w)*(f-w))>w){m[_][f]=0;continue}m[_][f]=this._qr.isDark(f-2*c<0?f:f>=n?f-2*c:f-c,_-2*c<0?_:_>=n?_-2*c:_-c)?1:0}}for(let _=0;_<p;_++)for(let f=0;f<p;f++)m[_][f]&&(d.draw(g+_*s,b+f*s,s,(N,T)=>{var D;return!!((D=m[_+N])!=null&&D[f+T])}),d._element&&this._dotsClipPath&&this._dotsClipPath.appendChild(d._element))}}drawCorners(){if(!this._qr)throw"QR code is not defined";const e=this._element,t=this._options;if(!e)throw"Element code is not defined";const n=this._qr.getModuleCount(),i=Math.min(t.width,t.height)-t.margin*2,r=t.shape===P.circle?i/Math.sqrt(2):i,s=Math.floor(r/n),o=s*7,a=s*3,d=Math.floor((t.width-n*s)/2),h=Math.floor((t.height-n*s)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach(([u,c,p])=>{var _,f,N,T,D,K,J,W,tt,et,nt,it;const g=d+u*s*(n-7),b=h+c*s*(n-7);let m=this._dotsClipPath,w=this._dotsClipPath;if(((_=t.cornersSquareOptions)!=null&&_.gradient||(f=t.cornersSquareOptions)!=null&&f.color)&&(m=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),m.setAttribute("id",`clip-path-corners-square-color-${u}-${c}`),this._defs.appendChild(m),this._cornersSquareClipPath=this._cornersDotClipPath=w=m,this._createColor({options:(N=t.cornersSquareOptions)==null?void 0:N.gradient,color:(T=t.cornersSquareOptions)==null?void 0:T.color,additionalRotation:p,x:g,y:b,height:o,width:o,name:`corners-square-color-${u}-${c}`})),(D=t.cornersSquareOptions)!=null&&D.type){const v=new dt({svg:this._element,type:t.cornersSquareOptions.type,color:t.cornersSquareOptions.color??t.dotsOptions.color});v.draw(g,b,o,p),v._element&&m&&m.appendChild(v._element)}else{const v=new B({svg:this._element,type:t.dotsOptions.type});for(let $=0;$<O.length;$++)for(let y=0;y<O[$].length;y++)(K=O[$])!=null&&K[y]&&(v.draw(g+$*s,b+y*s,s,(Q,V)=>{var R;return!!((R=O[$+Q])!=null&&R[y+V])}),v._element&&m&&m.appendChild(v._element))}if(((J=t.cornersDotOptions)!=null&&J.gradient||(W=t.cornersDotOptions)!=null&&W.color)&&(w=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),w.setAttribute("id",`clip-path-corners-dot-color-${u}-${c}`),this._defs.appendChild(w),this._cornersDotClipPath=w,this._createColor({options:(tt=t.cornersDotOptions)==null?void 0:tt.gradient,color:(et=t.cornersDotOptions)==null?void 0:et.color,additionalRotation:p,x:g+s*2,y:b+s*2,height:a,width:a,name:`corners-dot-color-${u}-${c}`})),(nt=t.cornersDotOptions)!=null&&nt.type){const v=new gt({svg:this._element,type:t.cornersDotOptions.type,color:t.cornersDotOptions.color??t.dotsOptions.color});v.draw(g+s*2,b+s*2,a,p),v._element&&w&&w.appendChild(v._element)}else{const v=new B({svg:this._element,type:t.dotsOptions.type});for(let $=0;$<q.length;$++)for(let y=0;y<q[$].length;y++)(it=q[$])!=null&&it[y]&&(v.draw(g+$*s,b+y*s,s,(Q,V)=>{var R;return!!((R=q[$+Q])!=null&&R[y+V])}),v._element&&w&&w.appendChild(v._element))}})}loadImage(){return new Promise((e,t)=>{const n=this._options,i=new Image;if(!n.image)return t("Image is not defined");typeof n.imageOptions.crossOrigin=="string"&&(i.crossOrigin=n.imageOptions.crossOrigin),this._image=i,i.onload=()=>{e()},i.src=n.image})}async drawImage({width:e,height:t,count:n,dotSize:i}){const r=this._options,s=Math.floor((r.width-n*i)/2),o=Math.floor((r.height-n*i)/2),a=s+r.imageOptions.margin+(n*i-e)/2,d=o+r.imageOptions.margin+(n*i-t)/2,h=e-r.imageOptions.margin*2,u=t-r.imageOptions.margin*2,c=document.createElementNS("http://www.w3.org/2000/svg","image");c.setAttribute("x",String(a)),c.setAttribute("y",String(d)),c.setAttribute("width",`${h}px`),c.setAttribute("height",`${u}px`);const p=await ot(r.image||"");c.setAttribute("href",p||""),this._element.appendChild(c)}_createColor({options:e,color:t,additionalRotation:n,x:i,y:r,height:s,width:o,name:a}){const d=o>s?o:s,h=document.createElementNS("http://www.w3.org/2000/svg","rect");if(h.setAttribute("x",String(i)),h.setAttribute("y",String(r)),h.setAttribute("height",String(s)),h.setAttribute("width",String(o)),h.setAttribute("clip-path",`url('#clip-path-${a}')`),e){let u;if(e.type===X.radial)u=document.createElementNS("http://www.w3.org/2000/svg","radialGradient"),u.setAttribute("id",a),u.setAttribute("gradientUnits","userSpaceOnUse"),u.setAttribute("fx",String(i+o/2)),u.setAttribute("fy",String(r+s/2)),u.setAttribute("cx",String(i+o/2)),u.setAttribute("cy",String(r+s/2)),u.setAttribute("r",String(d/2));else{const c=((e.rotation||0)+n)%(2*Math.PI),p=(c+2*Math.PI)%(2*Math.PI);let g=i+o/2,b=r+s/2,m=i+o/2,w=r+s/2;p>=0&&p<=.25*Math.PI||p>1.75*Math.PI&&p<=2*Math.PI?(g=g-o/2,b=b-s/2*Math.tan(c),m=m+o/2,w=w+s/2*Math.tan(c)):p>.25*Math.PI&&p<=.75*Math.PI?(b=b-s/2,g=g-o/2/Math.tan(c),w=w+s/2,m=m+o/2/Math.tan(c)):p>.75*Math.PI&&p<=1.25*Math.PI?(g=g+o/2,b=b+s/2*Math.tan(c),m=m-o/2,w=w-s/2*Math.tan(c)):p>1.25*Math.PI&&p<=1.75*Math.PI&&(b=b+s/2,g=g+o/2/Math.tan(c),w=w-s/2,m=m-o/2/Math.tan(c)),u=document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),u.setAttribute("id",a),u.setAttribute("gradientUnits","userSpaceOnUse"),u.setAttribute("x1",String(Math.round(g))),u.setAttribute("y1",String(Math.round(b))),u.setAttribute("x2",String(Math.round(m))),u.setAttribute("y2",String(Math.round(w)))}e.colorStops.forEach(({offset:c,color:p})=>{const g=document.createElementNS("http://www.w3.org/2000/svg","stop");g.setAttribute("offset",`${100*c}%`),g.setAttribute("stop-color",p),u.appendChild(g)}),h.setAttribute("fill",`url('#${a}')`),this._defs.appendChild(u)}else t&&h.setAttribute("fill",t);this._element.appendChild(h)}}const F={canvas:"canvas",svg:"svg"},z={};for(let l=0;l<=40;l++)z[l]=l;const H={L:"L",M:"M",Q:"Q",H:"H"},Y={type:F.canvas,shape:P.square,width:300,height:300,data:"",margin:0,qrOptions:{typeNumber:z[0],mode:void 0,errorCorrectionLevel:H.Q},imageOptions:{hideBackgroundDots:!0,imageSize:.4,crossOrigin:void 0,margin:0},dotsOptions:{type:"square",color:"#000"},backgroundOptions:{round:0,color:"#fff"}};function L(l){const e={...l};if(!e.colorStops||!e.colorStops.length)throw"Field 'colorStops' is required in gradient";return e.rotation?e.rotation=Number(e.rotation):e.rotation=0,e.colorStops=e.colorStops.map(t=>({...t,offset:Number(t.offset)})),e}function Z(l){const e={...l};return e.width=Number(e.width),e.height=Number(e.height),e.margin=Number(e.margin),e.imageOptions={...e.imageOptions,hideBackgroundDots:!!e.imageOptions.hideBackgroundDots,imageSize:Number(e.imageOptions.imageSize),margin:Number(e.imageOptions.margin)},e.margin>Math.min(e.width,e.height)&&(e.margin=Math.min(e.width,e.height)),e.dotsOptions={...e.dotsOptions},e.dotsOptions.gradient&&(e.dotsOptions.gradient=L(e.dotsOptions.gradient)),e.cornersSquareOptions&&(e.cornersSquareOptions={...e.cornersSquareOptions},e.cornersSquareOptions.gradient&&(e.cornersSquareOptions.gradient=L(e.cornersSquareOptions.gradient))),e.cornersDotOptions&&(e.cornersDotOptions={...e.cornersDotOptions},e.cornersDotOptions.gradient&&(e.cornersDotOptions.gradient=L(e.cornersDotOptions.gradient))),e.backgroundOptions&&(e.backgroundOptions={...e.backgroundOptions},e.backgroundOptions.gradient&&(e.backgroundOptions.gradient=L(e.backgroundOptions.gradient))),e}class j{constructor(e){this._options=e?Z(k(Y,e)):Y,this.update()}static _clearContainer(e){e&&(e.innerHTML="")}_setupSvg(){if(!this._qr)return;const e=new mt(this._options);this._svg=e.getElement(),this._svgDrawingPromise=e.drawQR(this._qr).then(()=>{var t;this._svg&&((t=this._extension)==null||t.call(this,e.getElement(),this._options))})}_setupCanvas(){var e;this._qr&&(this._canvas=document.createElement("canvas"),this._canvas.width=this._options.width,this._canvas.height=this._options.height,this._setupSvg(),this._canvasDrawingPromise=(e=this._svgDrawingPromise)==null?void 0:e.then(()=>{if(!this._svg)return;const t=this._svg,n=new XMLSerializer().serializeToString(t),r="data:image/svg+xml;base64,"+btoa(n),s=new Image;return new Promise(o=>{s.onload=()=>{var a,d;(d=(a=this._canvas)==null?void 0:a.getContext("2d"))==null||d.drawImage(s,0,0),o()},s.src=r})}))}async _getElement(e="png"){if(!this._qr)throw"QR code is empty";return e.toLowerCase()==="svg"?((!this._svg||!this._svgDrawingPromise)&&this._setupSvg(),await this._svgDrawingPromise,this._svg):((!this._canvas||!this._canvasDrawingPromise)&&this._setupCanvas(),await this._canvasDrawingPromise,this._canvas)}update(e){j._clearContainer(this._container),this._options=e?Z(k(this._options,e)):this._options,this._options.data&&(this._qr=x(this._options.qrOptions.typeNumber,this._options.qrOptions.errorCorrectionLevel),this._qr.addData(this._options.data,this._options.qrOptions.mode||rt(this._options.data)),this._qr.make(),this._options.type===F.canvas?this._setupCanvas():this._setupSvg(),this.append(this._container))}append(e){if(e){if(typeof e.appendChild!="function")throw"Container should be a single DOM node";this._options.type===F.canvas?this._canvas&&e.appendChild(this._canvas):this._svg&&e.appendChild(this._svg),this._container=e}}applyExtension(e){if(!e)throw"Extension function should be defined.";this._extension=e,this.update()}deleteExtension(){this._extension=void 0,this.update()}async getRawData(e="png"){if(!this._qr)throw"QR code is empty";const t=await this._getElement(e);if(!t)return null;if(e.toLowerCase()==="svg"){const i=new XMLSerializer().serializeToString(t);return new Blob([`<?xml version="1.0" standalone="no"?>\r
`+i],{type:"image/svg+xml"})}else return new Promise(n=>t.toBlob(n,`image/${e}`,1))}async download(e){if(!this._qr)throw"QR code is empty";let t="png",n="qr";typeof e=="string"?(t=e,console.warn("Extension is deprecated as argument for 'download' method, please pass object { name: '...', extension: '...' } as argument")):typeof e=="object"&&e!==null&&(e.name&&(n=e.name),e.extension&&(t=e.extension));const i=await this._getElement(t);if(i)if(t.toLowerCase()==="svg"){let s=new XMLSerializer().serializeToString(i);s=`<?xml version="1.0" standalone="no"?>\r
`+s;const o="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(s);G(o,`${n}.svg`)}else{const r=i.toDataURL(`image/${t}`);G(r,`${n}.${t}`)}}}S.cornerDotTypes=M,S.cornerSquareTypes=C,S.default=j,S.dotTypes=A,S.drawTypes=F,S.errorCorrectionLevels=H,S.errorCorrectionPercents=U,S.gradientTypes=X,S.modes=I,S.qrTypes=z,S.shapeTypes=P,Object.defineProperties(S,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
